{% extends 'adminlte/base.html' %}
{% block body_class %}
  {% block bodyclass %}
    sidebar-collapse
  {% endblock %}
{% endblock %}

{% load static %}

{% block title %}
  Arslan Al√ºminyum
{% endblock %}

{% block stylesheets %}
  {% include 'adminlte/lib/_styles.html' %}
  <style>
    .callout.callout-info {
        border-width: 40px; /* Adjust the size as needed */
        border-color: #17a2b8; /* Change the color if necessary */
    }
  </style>

{% endblock %}

{% block content %}
    <h1 class="pl-4">Bildirimler</h1>
    <hr>
    <div class="container-fluid">
      <div class="row px-4">
        <div class="col alert alert-info">
          <h5><i class="icon fas fa-info"></i> Info!</h5>
          Info preview.
        </div>
      </div>

      <div class="row">
        <div class="col-md-6">
            <h2 class="pl-4">Yeni YUDA</h2>
            <div class="row row-cols-2">
                {% for yuda in yudas %}
                <div class="col px-4">
                  <div class="notification-item w-100">
                    <div class="notification-border" id="nb{{ yuda.id}}" style="background-color: {{ yuda.is_marked|yesno:'blue,#e0e0e0' }}; color: {{ yuda.is_marked|yesno:'blue,#e0e0e0' }}" onclick="markAsMarked({{ yuda.id }})">
                      <span style="opacity: 0;">&nbsp;</span>
                    </div>
                    <div class="notification-content"id="nc{{ yuda.id}}" onclick="markNotificationAsRead({{ yuda.id }})">
                        <div class="d-flex justify-content-between">
                            <div>
                                <i class="fas fa-file mr-2"></i>
                                {{ yuda.Kisi }}
                            </div>
                            <small>{{ yuda.timestamp }}</small>
                        </div>
                        <div class="notiMessage">{{ yuda.message }}</div>
                        <div class="dropdown-divider"></div>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <div class="col-md-6">
            <h2 class="pl-4">Yorumlar</h2>
            <div class="row row-cols-2">
                {% for ycomment in ycomments %}
                <div class="col px-4">
                  <div class="notification-item w-100">
                    <div class="notification-border" id="nb{{ ycomment.id}}" style="background-color: {{ ycomment.is_marked|yesno:'blue,#e0e0e0' }}; color: {{ ycomment.is_marked|yesno:'blue,#e0e0e0' }}" onclick="markAsMarked({{ ycomment.id }})">
                      <span style="opacity: 0;">&nbsp;</span>
                    </div>
                    <div class="notification-content" id="nc{{ ycomment.id}}" onclick="markNotificationAsRead({{ ycomment.id }})">
                        <div class="d-flex justify-content-between">
                            <div>
                                <i class="fas fa-file mr-2"></i>
                                {{ ycomment.Kisi }}
                            </div>
                            <small>{{ ycomment.timestamp }}</small>
                        </div>
                        <div class="notiMessage">{{ ycomment.comment }}</div>
                        <div class="dropdown-divider"></div>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    </div>
{% endblock %}

{% block javascript %}
{% include 'adminlte/lib/_scripts.html' %}

<script>

  var notiMessages = document.getElementsByClassName('notiMessage');
  for (var i = 0; i < notiMessages.length; i++) {
      notiMessages[i].innerHTML = notiMessages[i].textContent;
  };

  
  function markNotificationAsRead(notificationId) {

        const data = {
            type: 'mark_as_read',
            notification_id: notificationId
        };
        socket.send(JSON.stringify(data));
    };

    function markAsMarked(notificationId) {
      console.log($(`#nb${notificationId}`).hasClass('notification-border blue'));
      //if class has blue remove if it doesn't have add
      if ($(`#nb${notificationId}`).hasClass('blue')) {
        $(`#nb${notificationId}`).removeClass('blue');
      }
      else {
        $(`#nb${notificationId}`).addClass('blue');
      }
      const data = {
          type: 'mark_as_marked',
          notification_id: notificationId,
      };
      socket.send(JSON.stringify(data));

    }


</script>

{% endblock %}